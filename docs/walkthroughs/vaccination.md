# Walkthrough

This walkthrough will show how a vaccination card can be issued, held, and proven using verifiable credentials with the Trinsic CLI. Feel free to follow along in a terminal using the CLI. We'll cover each part of Trinsic's platform during the tutorial. 
## Meet Allison

In this walkthrough we'll explore a scenario where Allison gets her vaccination certificate. She then uses this certificate to board an airline that requires proof of vaccination.

<!-- ```mermaid
journey
    section Issuance
      Obtain cert.: 3: Allison, Clinic
      Store in wallet: 3: Allison
    section Verification
      Request cert.: 3: Allison, Airline
      Share: 3: Allison
      Verify: 5: Airline
``` -->

In most credential exchange scenarios there are three primary roles - Issuer, Holder, and Verifier.

**Holder**: Stores issued credentials from an issuer. Most often this is the credential subject. Also generates passes to share with verifiers.

**Issuer**: Responsible for issuing signed credentials that attest information about a credential subject

**Verifier**: Verifies passes presented from holders.


In this case, Allison will be the holder, a vaccination clinic will be an issuer, and an airline will be the verifier. 
```
walkthrough
|- allison - Holder
|- clinic - Issuer
|- airline - Verifier
```

## Our SDKs
This tutorial is meant to share the concepts of verifiable credentials. So feel free to sit back and read through this without running any code. However, you can also follow along using one of our SDKs. 

We've set up some environments to use on Repl.it. If your language of choice isn't supported on repl.it, you can also run locally by installing the SDK of your choice.

=== "Trinsic CLI"
    
    - <a href="/cli/" target="_blank">Installation instructions</a> for the Trinsic CLI.

    Once the CLI is installed, clone our CLI example repository on Github to download the credential data for this walkthrough.
    
    ```
    git clone https://github.com/trinsic-id/cli-example && cd cli-example
    ```

    If you don't want to install locally, we also have a replit environment for you to use. In a new tab, you can open our <!--[demo environment](./demo.md)--> to use the CLI. This demo environment works best when run side-by-side the following walkthrough using two tabs in your browser.

   

=== "TypeScript"
    <a href="/web/" target="_blank">Installation instructions</a> for the Node/Browser SDk.

=== "C#"
    Let's create a new .NET console app that we will use to add our sample code

    ```bash
    dotnet new console -n TrinsicSample && cd TrinsicSample
    ```

    Now we'll follow the <a href="/dotnet/" target="_blank">installation instructions</a> for Dotnet.


=== "Python"

    - <a href="/python/" target="_blank">Installation instructions</a> for Python.


=== "Java"
    - <a href="/java/" target="_blank">Installation instructions</a> for Java.

    In this project, we'll be following along the [`java/src/test/java/trinsic/VaccineDemo.java`](https://github.com/trinsic-id/sdk/blob/main/java/src/test/java/trinsic/VaccineDemo.java) in our [SDK repository](https://github.com/trinsic-id/sdk)

=== "Ruby"
    - [Install Instructions](../ruby/index.md) 
    
=== "Go"
    - [Install Instructions](../go/index.md)
   

---

## Creating Accounts

We'll start by creating a Trinsic Wallet for each participant in this credential exchange. Wallets can be created by anyone, for anyone. In this scenario, we'll have three wallets. Allison will be the credential holder, the Airline will be the verifier, and the vaccination clinic will be the issuer.

When a new Trinsic account is created, a cloud wallet is created on our platform and an authentication key is generated by our SDK locally. Each person is the sole owner of their cloud wallet. They're meant to be easy to create so that you can create a cloud wallet for an end-user in your UX with very little friction. 


=== "Trinsic CLI"
    The CLI offers an interactive way of creating wallets. For demo purposes, we'll create all three on the same machine. However, this demo could be done with all three wallets created on three separate machines.
    
    When creating a wallet in the CLI, the wallet will store a private authentication token for the wallet in ~/.trinsic. If using the CLI with a real-world wallet, store this authentication token somewhere securely. 
    ```bash
    trinsic account login --description "Allison's Wallet" --alias allison && \
    trinsic account login --description "Airline's wallet" --alias airline && \
    trinsic account login --description "Vaccination Clinic" --alias clinic
    ```

=== "Typescript"
    <!--codeinclude-->
    ```javascript
    [Setup Wallets](../../web/test/VaccineDemoShared.ts) inside_block:setupActors
    ```
    <!--/codeinclude-->


=== "C#"
    <!--codeinclude-->
    ```csharp
    [Setup Wallets](../../dotnet/Tests/Tests.cs) inside_block:setupActors
    ```
    <!--/codeinclude-->


=== "Python"
    <!--codeinclude-->
    ```python
    [Setup Wallets](../../python/samples/vaccine_demo.py) inside_block:setupActors
    ```
    <!--/codeinclude-->


=== "Java"
    <!--codeinclude-->
    ```java
    [Setup Wallets](../../java/src/test/java/trinsic/VaccineDemo.java) inside_block:setupActors
    ```
    <!--/codeinclude-->

    
=== "Go"
    <!--codeinclude-->
    ```go
    [Setup Wallets](../../go/services/services_test.go) inside_block:setupActors
    ```
    <!--/codeinclude-->

If you would like to save the profile for future use, you can simply export the serialized profile to a local storage. Please note that the profiles contain sensitive key data, so they should be stored in a secure enclave.

<!-- === "Typescript" 
    
    ```javascript
    [Setup Wallets](../../web/test/VaccineDemoShared.ts) inside_block:storeAndRecallProfile
    ```
     
-->


=== "C#"
    <!--codeinclude-->
    ```csharp
    [Save and Load Profile](../../dotnet/Tests/Tests.cs) inside_block:storeAndRecallProfile
    ```
    <!--/codeinclude-->


=== "Python"    
    <!--codeinclude-->
    ```python
    [Save and Load Profile](../../python/samples/vaccine_demo.py) inside_block:storeAndRecallProfile
    ```
    <!--/codeinclude-->

=== "Java"
    <!--codeinclude-->
    ```java
    [Save and Load Profile](../../java/src/test/java/trinsic/VaccineDemo.java) inside_block:storeAndRecallProfile
    ```
    <!--/codeinclude-->

=== "Go"
    <!--codeinclude-->
    ```go
    [Save and Load Profile](../../go/services/services_test.go) inside_block:storeAndRecallProfile
    ```
    <!--/codeinclude-->


!!! note
    References: 

    - Manage access to cloud wallets with the [Account Service](../reference/services/account-service.md#login)
    - Learn more about [Wallets](../learn/wallets.md)
    - Read more about [security profiles](../reference/index.md#authorization) and authentication.

---

## Define a Template

=== "Trinsic CLI"

=== "Typescript"
    <!--codeinclude-->
    ```javascript
    [Define Template](../../web/test/CredentialTemplateShared.ts) inside_block:defineTemplate
    [Create Template](../../web/test/CredentialTemplateShared.ts) inside_block:createTemplate
    ```
    <!--/codeinclude-->

=== "C#"
    <!--codeinclude-->
    ```csharp
    [Create Template](../../dotnet/Tests/Tests.cs) inside_block:createTemplate
    ```
    <!--/codeinclude-->

=== "Python"
    <!--codeinclude-->
    ```python
    [Create Template](../../python/samples/templates_demo.py) inside_block:createTemplate
    ```
    <!--/codeinclude-->

=== "Java"
    <!--codeinclude-->
    ```java
    [Create Template](../../java/src/test/java/trinsic/TemplatesDemo.java) inside_block:createTemplate
    ```
    <!--/codeinclude-->

=== "Go"
    <!--codeinclude-->
    ```go
    [Create Template](../../go/services/credentialtemplate_service_test.go) inside_block:createTemplate
    ```
    <!--/codeinclude-->


## Create an Ecosystem

=== "Trinsic CLI"

=== "Typescript"

=== "C#"

=== "Python"

=== "Java"

## Issue a Credential
Upon receiving her vaccine, Allison also receives a digital certificate from the clinic. This certificate is digitally signed by the clinic, acting as an issuer.
The certificate is in a JSON form, and for this example, we will use the following JSON. Add this file to your project named `vaccination-certificate-unsigned.jsonld`.

=== "vaccination-certificate-unsigned.jsonld"
```json
----8<---- "devops/testdata/vaccination-certificate-unsigned.jsonld"
```

Behind the scenes, each credential is a JSON document that is signed with a special digital signature to make each piece of data in the credential separately verifiable.

Signatures are a way to make sure that credentials are not forged or tampered with between getting issued and verified. They also are how a verifier can know that the credential was issued by who the credential says it was issued by.

To issue this credential we'll specify links to the json files, set the active profile to the clinic, and call the issuance endpoint:

=== "Trinsic CLI"
    ```bash
    trinsic  --profile clinic issuer issue --document data/vaccination-certificate-unsigned.json --out vaccination-certificate-signed.json
    ```

=== "Typescript"
    <!--codeinclude-->
    ```javascript
    [Setup Wallets](../../web/test/VaccineDemoShared.ts) inside_block:issueCredential
    ```
    <!--/codeinclude-->

=== "C#"
    <!--codeinclude-->
    [C#](../../dotnet/Tests/Tests.cs) inside_block:issueCredential
    <!--/codeinclude-->

=== "Python"
    We specify links to the jsonld files:
    <!--codeinclude-->
    ```python
    [Data Paths](../../python/samples/vaccine_demo.py) inside_block:pathData
    ```
    <!--/codeinclude-->

    Let's set the active profile to the clinic, and call the issuance endpoint
    <!--codeinclude-->
    ```python
    [Issue Credential](../../python/samples/vaccine_demo.py) inside_block:issueCredential
    ```
    <!--/codeinclude-->


=== "Java"
    We specify links to the jsonld files:
    <!--codeinclude-->
    ```java
    [Data Paths](../../java/src/test/java/trinsic/VaccineDemo.java) inside_block:pathData
    ```
    <!--/codeinclude-->

    Let's set the active profile to the clinic, and call the issuance endpoint
    <!--codeinclude-->
    ```java
    [Issue Credential](../../java/src/test/java/trinsic/VaccineDemo.java) inside_block:issueCredential
    ```
    <!--/codeinclude-->

=== "Go"
    <!--codeinclude-->
    ```go
    [Data Paths](../../go/services/services_test.go) inside_block:pathData
    ```
    <!--/codeinclude-->
    <!--codeinclude-->
    ```go
    [Issue Credential](../../go/services/services_test.go) inside_block:issueCredential
    ```
    <!--/codeinclude-->



!!! info
    Reference: 
    
    - Learn more about how to [issue a credential](../reference/services/wallet-service.md#issue-credential)
    - Learn more about [verifiable credentials](../learn/credentials.md)


---
## Send Credential to Allison

At this point, the clinic can send the signed credential to Allison using any available methods. These methods can include any message exchange protocol, or a custom transport. In this case, we'll assume that the credential was delivered to Allison in an offline environment.

Sending credentials securely is an important part of maintaining the privacy of a credential holder. At this point we do not have a standard way of sending credentials to a wallet. There are a couple of options available. 

First, if you've onboarded two wallets on the Trinsic platform there is a way to send credentials to a wallet via the wallet's email address. This method is a temporary fix. We recommend using a secure channel of communication within your application for sending and receiving credentials. Sending via https or another encrypted messaging protocol is critical to ensure the personal information inside the credential is not accidentally leaked. As Trinsic's platform develops, we will embed an encrypted messaging protocol called DIDComm (decentralized identifier communication) to exchange credentials between any wallet.

!!! info
    Dive Deeper: 

    - Learn more about how to [exchange credentials](../reference/services/credential-service.md#exchange-credentials)
    

---

## Store Credential in Wallet
Once Allison receives the credential, she or her wallet application can store it within her wallet. She can use any device that she's authorized to use with her wallet. Storing credentials securely is also important to maintaining Allison's privacy. 


=== "Trinsic CLI"

    ```bash
    trinsic --profile allison wallet insert-item --item vaccination-certificate-signed.json
    ```

=== "Typescript"
    <!--codeinclude-->
    ```javascript
    [Store Credential](../../web/test/VaccineDemoShared.ts) inside_block:storeCredential
    ```
    <!--/codeinclude-->

=== "C#"
    <!--codeinclude-->
    ```csharp
    [Store Credential](../../dotnet/Tests/Tests.cs) inside_block:storeCredential
    ```
    <!--/codeinclude-->

=== "Python"
    <!--codeinclude-->
    ```python
    [Store Credential](../../python/samples/vaccine_demo.py) inside_block:storeCredential
    ```
    <!--/codeinclude-->

=== "Java"
    <!--codeinclude-->
    ```java
    [Store Credential](../../java/src/test/java/trinsic/VaccineDemo.java) inside_block:storeCredential
    ```
    <!--/codeinclude-->

=== "Go"
    <!--codeinclude-->
    ```go
    [Store Credential](../../go/services/services_test.go) inside_block:storeCredential
    ```
    <!--/codeinclude-->


Note down the response `item_id` printed to the console for the next step.

!!! info
    Reference: [Insert Record](../reference/services/wallet-service.md#insert-item)


---

## Create a Proof of Vaccination
Before boarding an airplane, Allison must show a proof of vaccination. The request for this proof also comes in a form of JSON, in this case a JSON-LD frame.

This request can be communicated using any exchange protocol. Again, we'll assume this was done offline.

Let's save this request in a file named `vaccination-certificate-frame.jsonld`

=== "vaccination-certificate-frame.jsonld"
```json
----8<---- "devops/testdata/vaccination-certificate-frame.jsonld"
```

This request asks Allison to provide proof of valid vaccination certificate, including the `issuer`, `batchNumber`and `countryOfVaccination` fields.

Allison can use the [Create Proof](../reference/services/wallet-service/#create-proof) functions to build a proof that will share only the requested fields.

Now let's create a proof for Allison. She may choose to generate this proof before going to the airport, or might generate it right as she boards.



=== "Trinsic CLI"
    Replace the `<item_id>` in the generate proof command below with the output from the `insert_item` above.

    ```bash
    trinsic --profile allison issuer create-proof --document-id "<item-id>" --out vaccination-certificate-partial-proof.json --reveal-document data/vaccination-certificate-frame.json
    ```

=== "Typescript"
    <!--codeinclude-->
    ```javascript
    [Share Credential](../../web/test/VaccineDemoShared.ts) inside_block:shareCredential
    ```
    <!--/codeinclude-->

=== "C#"
    <!--codeinclude-->
    ```csharp
    [Share Credential](../../dotnet/Tests/Tests.cs) inside_block:shareCredential
    ```
    <!--/codeinclude-->


=== "Python"
    <!--codeinclude-->
    ```python
    [Share Credential](../../python/samples/vaccine_demo.py) inside_block:shareCredential
    ```
    <!--/codeinclude-->

=== "Java"
    <!--codeinclude-->
    ```java
    [Share Credential](../../java/src/test/java/trinsic/VaccineDemo.java) inside_block:shareCredential
    ```
    <!--/codeinclude-->

=== "Go"
    <!--codeinclude-->
    ```go
    [Share Credential](../../go/services/services_test.go) inside_block:shareCredential
    ```
    <!--/codeinclude-->

Take a look at the proof. Notice how only the attributes included in the `frame` are included with the proof.

Allison sends this proof to the airline for them to verify.

!!! info
    Reference: [Create Proof](../reference/services/wallet-service.md#create-proof)

---

## Verify Proof
Once the airline receives the proof, they can now verify it to ensure its authenticity. Because Allison sent a proof of her vaccination credential and not the credential itself, the airline only receives its required information.

=== "Trinsic CLI"
    ```bash
    trinsic --profile airline issuer verify-proof --proof-document vaccination-certificate-partial-proof.json
    ```

=== "Typescript"
    <!--codeinclude-->
    ```javascript
    [Verify Credential](../../web/test/VaccineDemoShared.ts) inside_block:verifyCredential
    ```
    <!--/codeinclude-->

=== "C#"
    <!--codeinclude-->
    ```csharp
    [Verify Credential](../../dotnet/Tests/Tests.cs) inside_block:verifyCredential
    ```
    <!--/codeinclude-->


=== "Python"
    <!--codeinclude-->
    ```python
    [Verify Credential](../../python/samples/vaccine_demo.py) inside_block:verifyCredential
    ```
    <!--/codeinclude-->
   

=== "Java"
    <!--codeinclude-->
    ```java
    [Verify Credential](../../java/src/test/java/trinsic/VaccineDemo.java) inside_block:verifyCredential
    ```
    <!--/codeinclude-->

=== "Go"
    <!--codeinclude-->
    ```go
    [Verify Credential](../../go/services/services_test.go) inside_block:verifyCredential
    ```
    <!--/codeinclude-->


Watch for the result of `true` to know that the credential successfully passed all of the verification processes.

!!! info
    Reference: [Verify Proof](../reference/services/credential-service.md#verify-proof)

---

<!-- ## Check Issuer Status


=== "Trinsic CLI"


=== "Typescript"


=== "C#"


=== "Python"
   

=== "Java" -->

---

## Full Source Code

=== "Typescript"
    [web](https://github.com/trinsic-id/sdk/tree/main/web/test/VaccineDemoShared.ts)    

=== "C#"
    This sample is available in our [dotnet](https://github.com/trinsic-id/sdk/blob/main/dotnet/Tests/Tests.cs#L42) directory. 

    <!-- TODO: include working replit embed -->


=== "Python"
    This sample is available as [`ecosystem_demo.py`](https://github.com/trinsic-id/sdk/blob/main/python/samples/ecosystem_demo.py)

=== "Java"
    This sample is available in the [Java](https://github.com/trinsic-id/sdk/tree/main/java/src/test/java) directory.

## Next Steps:

Congratulations! If you've completed all the steps of this walkthrough, you've just created a mini ecosystem of issuers, verifiers, and holders all exchanging credentials. Depending on your goals, there are a couple of possible next steps to take. 


- Try out a sample app
- Learn more about wallets, credentials, templates, and ecosystems
- Review the SDK Reference


### Sample Applications
We have language specific sample applications that you can run to understand how the Trinsic SDK works in a development environment. 

=== "Typescript"
    This sample is available in our [node directory](https://github.com/trinsic-id/sdk-examples/tree/main/web/basic)  
=== "C#"
    This sample is available in our [dotnet directory](https://github.com/trinsic-id/sdk/blob/main/dotnet/Tests/Tests.cs). 
=== "Python"
    This sample is available in the [python directory](https://github.com/trinsic-id/sdk/tree/main/python/samples/vaccine_demo.py).
=== "Java"
    This sample is available in our Github repo in the [java directory](https://github.com/trinsic-id/sdk/tree/main/java/src/test/java).
